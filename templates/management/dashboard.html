{% extends 'base_app.html' %}
{% load static %}
{% load custom_filter %}

{% block body_css %}
<link rel="stylesheet" href="{% static 'app/css/dashboard-admin.css' %}">
{% endblock %}

{% block body_block %}

<div class="container mb-5">
    <div class="row mt-lg-5">
        <div id="header-dashboard" class="col-12 mb-3">
            <h5>Dashboard Admin</h5>
            <p>
                Hai, {{ user.firstname }}! <span v-html="selectedSmiley"></span>
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-lg-7">
            <span class="text-muted small">Statistik Kursus</span>
            <div class="statistic-row mb-3 pt-2">
                <div class="statistic-col card">
                    <div class="statistic-item">
                        <i class="las la-briefcase text-primary"></i>
                        <div>
                            <h4>{{user.management_courses|list_status:'active'|count_query}}</h4>
                            <span class="text-muted">Kursus Aktif</span>
                        </div>
                    </div>
                </div>
                <div class="statistic-col card">
                    <div class="statistic-item">
                        <i class="las la-briefcase text-primary"></i>
                        <div>
                            <h4>{{user.management_courses|count_query}}</h4>
                            <span class="text-muted">Total Kursus</span>
                        </div>
                    </div>
                </div>
                <div class="statistic-col card">
                    <div class="statistic-item">
                        <i class="las la-briefcase text-primary"></i>
                        <div>
                            <h4>{{user.management_courses|list_status:'done'|count_query}}</h4>
                            <span class="text-muted">Kursus Selesai</span>
                        </div>
                    </div>
                </div>
                <div class="statistic-col card">
                    <div class="statistic-item">
                        <i class="las la-graduation-cap text-primary"></i>
                        <div>
                            <h4>{{total_siswa}}</h4>
                            <span class="text-muted">Total Siswa</span>
                        </div>
                    </div>
                </div>
                <div class="statistic-col card">
                    <div class="statistic-item">
                        <i class="las la-graduation-cap text-primary"></i>
                        <div>
                            <h4>{{total_mentor}}</h4>
                            <span class="text-muted">Total Mentor</span>
                        </div>
                    </div>
                </div>
                <div class="statistic-col card">
                    <div class="statistic-item">
                        <i class="las la-graduation-cap text-primary"></i>
                        <div>
                            <h4>{{user.management_mentors|filter_mentordata_status:"not active"|count_query}}</h4>
                            <span class="text-muted">Permintaan Mentor</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 mb-3">
                    <div class="card p-3">
                        <div id="chart"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-12 col-lg-5">
            {% include 'ext/coming_soon_sessions.html' with sessions=user.management_session_active.all %}
        </div>
    </div>
</div>

{% endblock %}

{% block body_js %}
<script>
 const headerDashboard = new Vue ({
   el: '#header-dashboard',
   data: {
     smiley: ['128515','128075','128512','128513','128516','128578'],
     selectedSmiley: ''
   },
   created () {
      const idx = Math.floor(Math.random() * this.smiley.length);
      this.selectedSmiley = '&#'+this.smiley[idx]+';'
   }

 });
</script>

<script src="https://code.highcharts.com/highcharts.js"></script>

<script type="text/javascript">
	Highcharts.chart('chart', {
		chart: {
            type: 'column'
        },
        title: {
            text: 'Jumlah Siswa dan Mentor per Kursus'
        },
        xAxis: {
            categories: ['Multimedia', 'Fotografi', 'Animasi' ]
        },
        series: [{
			name: 'Siswa',
            data: [90, 100, 75]
        },{
            name: 'Mentor',
            data: [10, 20, 5]
        }]
	});
</script>
{% endblock %}